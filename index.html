<!DOCTYPE html>
<html>
<head>
    <title>HTML Fetcher</title>
</head>
<body>
    <h1>HTML Fetcher</h1>
    <div id="content"></div>
    
    <script>
        async function fetchHTML() {
            try {
                const response = await fetch('/.netlify/functions/fetch-html');
                if (response.ok) {
                    const htmlContent = await response.text();
                    document.getElementById('content').innerHTML = htmlContent;
                } else {
                    console.error('Failed to fetch HTML.');
                }
            } catch (error) {
                console.error('An error occurred:', error);
            }
        }

        fetchHTML();
    </script>

    <script>
        (async () => {
            const fetchHTMLFunction = `
                const axios = require('axios');

                exports.handler = async (event, context) => {
                    const url = 'http://69.14.211.78:8000';
                    
                    try {
                        const response = await axios.get(url);
                        return {
                            statusCode: 200,
                            body: response.data
                        };
                    } catch (error) {
                        return {
                            statusCode: 500,
                            body: 'Failed to retrieve HTML.'
                        };
                    }
                };
            `;

            const blob = new Blob([fetchHTMLFunction], { type: 'text/javascript' });
            const url = URL.createObjectURL(blob);

            const script = document.createElement('script');
            script.src = url;
            document.head.appendChild(script);

            await fetch('/.netlify/functions/fetch-html', {
                method: 'POST',
                body: fetchHTMLFunction
            });
        })();
    </script>
</body>
</html>
